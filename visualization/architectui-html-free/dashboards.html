<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Language" content="en">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Analytics Dashboard - This is an example dashboard created using build-in elements and components.</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, shrink-to-fit=no" />
    <meta name="description" content="This is an example dashboard created using build-in elements and components.">
    <meta name="msapplication-tap-highlight" content="no">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"> </script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script src="leaflet.heat.js"></script>
    <!--
    =========================================================
    * ArchitectUI HTML Theme Dashboard - v1.0.0
    =========================================================
    * Product Page: https://dashboardpack.com
    * Copyright 2019 DashboardPack (https://dashboardpack.com)
    * Licensed under MIT (https://github.com/DashboardPack/architectui-html-theme-free/blob/master/LICENSE)
    =========================================================
    * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
    -->
    <link href="./main.css" rel="stylesheet">
    <!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">-->
    <style type="text/css">
        #map {position: absolute; top: 0; bottom: 0; left: 0; right: 0;}
    </style>
</head>
<body>
    <div class="app-container app-theme-white body-tabs-shadow fixed-sidebar fixed-header">
        <div class="app-main">
                <div class=>
                    <div class="app-main__inner">
                        <div class="app-page-title">
                            <div class="page-title-wrapper">
                                <div class="page-title-heading">
                                    <div class="page-title-icon">
                                        <i class="pe-7s-clock icon-gradient bg-mean-fruit">
                                        </i>
                                    </div>
                                    <div><b>Customer Analytics</b>
                                        <div class="page-title-subheading">This dashboard displays trends relating to customer behavior.

                                        </div>
                                    </div>
                                </div>

                                <div class="page-title-actions">
                                    <button type="button" class="btn-shadow mr-3 btn btn-success" data-toggle="modal" data-target="#myModal" onclick="getJSON(); getDemographicsJSON()">Query Analytics</button>
                                    
                                    <button type="button" data-toggle="tooltip" title="Notifications" data-placement="bottom" class="btn-shadow mr-3 btn btn-dark">
                                        <i class="fa fa-bell"></i>
                                    </button>
                                    <div class="d-inline-block dropdown">
                                        <button type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="btn-shadow btn btn-info">
                                            <span class="btn-icon-wrapper pr-2 opacity-7">
                                                <i class="fa fa-download fa-w-20"></i>
                                            </span>
                                            Download
                                        </button>
                                        <div tabindex="-1" role="menu" aria-hidden="true" class="dropdown-menu dropdown-menu-right">
                                            <h6 tabindex="-1" class="dropdown-header">Select File Type</h6>
                                            <a href="http://localhost:3000" download rel="noopener noreferrer" target="_blank"><button type="button" tabindex="0" class="dropdown-item" id="cmd">PDF Document (.pdf)</button></a>
                                            <button type="button" tabindex="0" class="dropdown-item">Microsoft Word (.docx)</button>
                                            <button type="button" tabindex="0" class="dropdown-item">Plain Text (.txt)</button>
                                            <button type="button" tabindex="0" class="dropdown-item">Web Page (.html, zipped)</button>
                                        </div>
                                    </div>
                                </div>    
                            </div>
                        </div>
                        <!-- <iframe src="https://www.google.com/maps/embed?" width="600" height="450" id="map" style="border:2px;" allowfullscreen="" loading="lazy"></iframe>-->
                        <div class="container">
                            <div id="map"></div>
                        </div>

                        <!--
                        <div id="caContent">
                            <div class="row">
                                <div class="col-md-6 col-xl-4">
                                    <div class="card mb-3 widget-content bg-midnight-bloom">
                                        <div class="widget-content-wrapper text-white">
                                            <div class="widget-content-left">
                                                <div class="widget-heading">Total In-Store Visitors</div>
                                                <div class="widget-subheading"># of people</div>
                                            </div>
                                            <div class="widget-content-right">
                                                <div class="widget-numbers text-white"><span id="totalCountVal">46</span></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 col-xl-4">
                                    <div class="card mb-3 widget-content bg-arielle-smile">
                                        <div class="widget-content-wrapper text-white">
                                            <div class="widget-content-left">
                                                <div class="widget-heading">Average Time Spent</div>
                                                <div class="widget-subheading">mins</div>
                                            </div>
                                            <div class="widget-content-right">
                                                <div class="widget-numbers text-white"><span id="undistancedCountVal">15.2</span></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 col-xl-4">
                                    <div class="card mb-3 widget-content bg-grow-early">
                                        <div class="widget-content-wrapper text-white">
                                            <div class="widget-content-left">
                                                <div class="widget-heading">Conversion Rate</div>
                                                <div class="widget-subheading">total / purchases</div>
                                            </div>
                                            <div class="widget-content-right">
                                                <div class="widget-numbers text-white"><span id="unmaskedCountVal">21.4%</span></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="d-xl-none d-lg-block col-md-6 col-xl-4">
                                    <div class="card mb-3 widget-content bg-premium-dark">
                                        <div class="widget-content-wrapper text-white">
                                            <div class="widget-content-left">
                                                <div class="widget-heading">Total Customers</div>
                                                <div class="widget-subheading"># of customers</div>
                                            </div>
                                            <div class="widget-content-right">
                                                <div class="widget-numbers text-warning"><span id="violationsCountVal">3398</span></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="mb-3 card">
                                        <div class="card-header-tab card-header-tab-animation card-header">
                                            <div class="card-header-title">
                                                <i class="header-icon lnr-apartment icon-gradient bg-love-kiss"> </i>
                                                Heat Map
                                            </div>
                                            <ul class="nav">
                                                <li class="nav-item"><a href="javascript:void(0);" class="active nav-link">Graph</a></li>
                                                <li class="nav-item"><a href="javascript:void(0);" class="nav-link second-tab-toggle">Description</a></li>
                                            </ul>
                                        </div>
                                        <div class="card-body">
                                            <div class="tab-content">
                                                <div class="tab-pane fade show active" id="tabs-eg-77">
                                                    <div class="mb-3 widget-chart widget-chart2 text-left w-100">
                                                        <div class="widget-chat-wrapper-outer">
                                                            <div class="widget-chart-wrapper widget-chart-wrapper-lg opacity-10 m-0">- ->
                                                <!- -<div id="map_plot"></div>- ->

                                                                <img src="assets/images/heatmap.jpg" width="950px" height="500px"></img>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            
                                <!- -
                                <div class="col-md-12 col-lg-6">
                                    <div class="mb-3 card">
                                        <div class="card-header-tab card-header">
                                            <div class="card-header-title">
                                                <i class="header-icon lnr-rocket icon-gradient bg-tempting-azure"> </i>
                                                3D Plot
                                            </div>
                                            <div class="btn-actions-pane-right">                                        </div>
                                        </div>
                                        <div class="tab-content">
                                            <div id="scatter_plot">
                                            </div>
                                        </div>
                                        
                                    </div>
                                </div>
                            - ->
                            </div>
                            <div class="row">
                                <div class="col-md-6 col-xl-4">
                                    <div class="card mb-3 widget-content">
                                        <div class="widget-content-outer">
                                            <div class="widget-content-wrapper">
                                                <div class="widget-content-left">
                                                    <div class="widget-heading">Most Popular Aisle</div>
                                                    <!- -<div class="widget-subheading">(hours)</div>- ->
                                                </div>
                                                <div class="widget-content-right">
                                                    <div class="widget-numbers text-success">7</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 col-xl-4">
                                    <div class="card mb-3 widget-content">
                                        <div class="widget-content-outer">
                                            <div class="widget-content-wrapper">
                                                <div class="widget-content-left">
                                                    <div class="widget-heading">Most Purchased Product</div>
                                                    <!- -<div class="widget-subheading">Revenue streams</div>- ->
                                                </div>
                                                <div class="widget-content-right">
                                                    <div class="widget-numbers text-warning">Water Bottles</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        -->
                        <!--
                        <br> <br> <br>
                        <div class="app-page-title">
                            <div class="page-title-wrapper">
                                <div class="page-title-heading">
                                    <div class="page-title-icon">
                                        <i class="pe-7s-graph2 icon-gradient bg-mean-fruit">
                                        </i>
                                    </div>
                                    <div><b>Demographics</b>
                                        <div class="page-title-subheading">Race, age, gender, etc.
                                        </div>
                                    </div>
                                </div>
                                <div class="page-title-actions">
                                    <button type="button" data-toggle="tooltip" title="Notifications" data-placement="bottom" class="btn-shadow mr-3 btn btn-dark">
                                        <i class="fa fa-bell"></i>
                                    </button>
                                    <div class="d-inline-block dropdown">
                                        <button type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="btn-shadow btn btn-info">
                                            <span class="btn-icon-wrapper pr-2 opacity-7">
                                                <i class="fa fa-download fa-w-20"></i>
                                            </span>
                                            Download
                                        </button>
                                        <div tabindex="-1" role="menu" aria-hidden="true" class="dropdown-menu dropdown-menu-right">
                                            <h6 tabindex="-1" class="dropdown-header">Select File Type</h6>
                                            <button type="button" tabindex="0" class="dropdown-item">PDF Document (.pdf)</button>
                                            <button type="button" tabindex="0" class="dropdown-item">Microsoft Word (.docx)</button>
                                            <button type="button" tabindex="0" class="dropdown-item">Plain Text (.txt)</button>
                                            <button type="button" tabindex="0" class="dropdown-item">Web Page (.html, zipped)</button>
                                        </div>
                                    </div>
                                </div>  
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 col-xl-4">
                                <div class="card mb-3 widget-content bg-midnight-bloom">
                                    <div class="widget-content-wrapper text-white">
                                        <div class="widget-content-left">
                                            <div class="widget-heading">Most Common Race</div>
                                            <!- -<div class="widget-subheading">Good, Medium, Bad, Critical</div>- ->
                                        </div>
                                        <div class="widget-content-right">
                                            <div class="widget-numbers text-white"><span id = "enforcement_status_val">Asian-South</span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6 col-xl-4">
                                <div class="card mb-3 widget-content bg-arielle-smile">
                                    <div class="widget-content-wrapper text-white">
                                        <div class="widget-content-left">
                                            <div class="widget-heading">Average Age</div>
                                            <!- -<div class="widget-subheading">Distance between people</div>- ->
                                        </div>
                                        <div class="widget-content-right">
                                            <div class="widget-numbers text-white"><span id = "average_dist_val">32.6</span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6 col-xl-4">
                                <div class="card mb-3 widget-content bg-grow-early">
                                    <div class="widget-content-wrapper text-white">
                                        <div class="widget-content-left">
                                            <div class="widget-heading">Most Common Gender</div>
                                            <!- -<div class="widget-subheading"># without face mask</div>- ->
                                        </div>
                                        <div class="widget-content-right">
                                            <div class="widget-numbers text-white"><span id = "average_unmasked_val">Female</span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="d-xl-none d-lg-block col-md-6 col-xl-4">
                                <div class="card mb-3 widget-content bg-premium-dark">
                                    <div class="widget-content-wrapper text-white">
                                        <div class="widget-content-left">
                                            <div class="widget-heading">Total # Of Families</div>
                                            <!- -<div class="widget-subheading">Revenue streams</div>- ->
                                        </div>
                                        <div class="widget-content-right">
                                            <div class="widget-numbers text-warning"><span id = "average_undistanced_val">98</span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12 col-lg-6">
                                <div class="mb-3 card">
                                    <div class="card-header-tab card-header-tab-animation card-header">
                                        <div class="card-header-title">
                                            <i class="header-icon lnr-apartment icon-gradient bg-love-kiss"> </i>
                                            People vs. Time
                                        </div>
                                        <!- -
                                        <ul class="nav">
                                            <li class="nav-item"><a href="javascript:void(0);" class="active nav-link">Graph</a></li>
                                            <li class="nav-item"><a href="javascript:void(0);" class="nav-link second-tab-toggle">Description</a></li>
                                        </ul>
                                    - ->
                                    </div>
                                    <div class="card-body">
                                        <div class="tab-content">
                                            <div class="tab-pane fade show active" id="tabs-eg-77">
                                                <div class="card mb-3 widget-chart widget-chart2 text-left w-100">
                                                    <div class="widget-chat-wrapper-outer">
                                                        <div class="widget-chart-wrapper widget-chart-wrapper-lg opacity-10 m-0">
                                                            <div style="height: 202px">
                                                                <canvas id="line-chart"></canvas>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12 col-lg-6">
                                <div class="mb-3 card">
                                    <div class="card-header-tab card-header">
                                        <div class="card-header-title">
                                            <i class="header-icon lnr-rocket icon-gradient bg-tempting-azure"> </i>
                                            Gender Comparison
                                        </div>
                                        <div class="btn-actions-pane-right">
                                        </div>
                                    </div>
                                    <div class="card-body">
                                        <div class="tab-content">
                                            <div class="card tab-pane fade active show" id="tab-eg-55">
                                                <div class="widget-chart p-3">
                                                    <div style="height: 425px">
                                                        <canvas id="chart-horiz-bar"></canvas>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12 col-lg-6">
                                <div class="mb-3 card">
                                    <div class="card-header-tab card-header">
                                        <div class="card-header-title">
                                            <i class="header-icon lnr-rocket icon-gradient bg-tempting-azure"> </i>
                                            Age Comparison
                                        </div>
                                        <div class="btn-actions-pane-right">
                                        </div>
                                    </div>
                                    <div class="card-body">
                                        <div class="tab-content">
                                            <div class="card tab-pane fade active show" id="tab-eg-55">
                                                <div class="widget-chart p-3">
                                                    <div style="height: 425px">
                                                        <canvas id="age-chart-horiz-bar"></canvas>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12 col-lg-6">
                                <div class="mb-3 card">
                                    <div class="card-header-tab card-header">
                                        <div class="card-header-title">
                                            <i class="header-icon lnr-rocket icon-gradient bg-tempting-azure"> </i>
                                            Race Comparison
                                        </div>
                                        <div class="btn-actions-pane-right">
                                        </div>
                                    </div>
                                    <div class="card-body">
                                        <div class="tab-content">
                                            <div class="card tab-pane fade active show" id="tab-eg-55">
                                                <div class="widget-chart p-3">
                                                    <div style="height: 425px">
                                                        <canvas id="race-chart-horiz-bar"></canvas>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            </div>
                            <div>
                                <div class="col-md-12">
                                    <div class="main-card mb-3 card">
                                        <div class="card-header">Comparisons
                                            <div class="btn-actions-pane-right">
                                                <div role="group" class="btn-group-sm btn-group">
                                                    <button class="active btn btn-focus">Last Week</button>
                                                    <button class="btn btn-focus">Last Month</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="table-responsive">
                                            <table class="align-middle mb-0 table table-borderless table-striped table-hover">
                                                <thead>
                                                <tr>
                                                    <th class="text-center">Camera #</th>
                                                    <th>Aisle #</th>
                                                    <th class="text-center">Most Popular Product</th>
                                                    <th class="text-center">Number of purchases</th>
                                                    <th class="text-center">Aisle Sales Status</th>
                                                    <th class="text-center">Actions</th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                <tr>
                                                    <td class="text-center text-muted">1</td>
                                                    <td>
                                                        <div class="widget-content p-0">
                                                            <div class="widget-content-wrapper">
                                                                <div class="widget-content-left flex2">
                                                                    <div class="widget-heading">1</div>
                                                                    <!- -<div class="widget-subheading opacity-7">Web Developer</div>- ->
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td class="text-center">Toothpaste</td>
                                                    <td class="text-center">
                                                        68
                                                    </td>
                                                    <td class="text-center">
                                                        <div class="badge badge-pill badge-success">Good</div>
                                                    </td>
                                                    <td class="text-center d-inline-block dropdown">
                                                        <button type="button" id="PopoverCustomT-1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="btn btn-primary btn-sm">Improvements</button>
                                                        <div tabindex="-1" role="menu" aria-hidden="true" class="dropdown-menu dropdown-menu-right">
                                                            <h6 tabindex="-1" class="dropdown-header">Move Toothpaste to ends of the ailse for higher customer attraction and sales</h6>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="text-center text-muted">1</td>
                                                    <td>
                                                        <div class="widget-content p-0">
                                                            <div class="widget-content-wrapper">
                                                                <div class="widget-content-left flex2">
                                                                    <div class="widget-heading">2</div>
                                                                    <!- -<div class="widget-subheading opacity-7">Etiam sit amet orci eget</div>- ->
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td class="text-center">Notebooks</td>
                                                    <td class="text-center">21</td>
                                                    <td class="text-center">
                                                        <div class="badge badge-pill badge-danger">Bad</div>
                                                    </td>
                                                    <td class="text-center d-inline-block dropdown">
                                                        <button type="button" id="PopoverCustomT-1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="btn btn-primary btn-sm">Improvements</button>
                                                        <div tabindex="-1" role="menu" aria-hidden="true" class="dropdown-menu dropdown-menu-right">
                                                            <h6 tabindex="-1" class="dropdown-header">Feedback</h6>
                                                            <ul>
                                                                <li>Move Toothpaste to ends of the ailse for higher customer attraction and sales.</li>
                                                                <li>Keep all products in this ailse hygiene related instead of mixing.</li>
                                                            </ul>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="text-center text-muted">2</td>
                                                    <td>
                                                        <div class="widget-content p-0">
                                                            <div class="widget-content-wrapper">
                                                                <div class="widget-content-left flex2">
                                                                    <div class="widget-heading">3</div>
                                                                    <!- -<div class="widget-subheading opacity-7">Lorem ipsum dolor sic</div>- ->
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td class="text-center">Door Mats</td>
                                                    <td class="text-center">43</td>
                                                    <td class="text-center">
                                                        <div class="badge badge-pill badge-warning">Medium</div>
                                                    </td>
                                                    <td class="text-center d-inline-block dropdown">
                                                        <button type="button" id="PopoverCustomT-1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="btn btn-primary btn-sm">Improvements</button>
                                                        <div tabindex="-1" role="menu" aria-hidden="true" class="dropdown-menu dropdown-menu-right">
                                                            <h6 tabindex="-1" class="dropdown-header">Move Toothpaste to ends of the ailse for higher customer attraction and sales</h6>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="text-center text-muted">2</td>
                                                    <td>
                                                        <div class="widget-content p-0">
                                                            <div class="widget-content-wrapper">
                                                                <div class="widget-content-left flex2">
                                                                    <div class="widget-heading">4</div>
                                                                    <!- -<div class="widget-subheading opacity-7">UI Designer</div>- ->
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td class="text-center">Toy Car</td>
                                                    <td class="text-center">188</td>
                                                    <td class="text-center">
                                                        <div class="badge badge-pill badge-success">Good</div>
                                                    </td>
                                                    <td class="text-center d-inline-block dropdown">
                                                        <button type="button" id="PopoverCustomT-1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="btn btn-primary btn-sm">Improvements</button>
                                                        <div tabindex="-1" role="menu" aria-hidden="true" class="dropdown-menu dropdown-menu-right">
                                                            <h6 tabindex="-1" class="dropdown-header">Move Toothpaste to ends of the ailse for higher customer attraction and sales</h6>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="text-center text-muted">3</td>
                                                    <td>
                                                        <div class="widget-content p-0">
                                                            <div class="widget-content-wrapper">
                                                                <div class="widget-content-left flex2">
                                                                    <div class="widget-heading">5</div>
                                                                    <!- -<div class="widget-subheading opacity-7">UI Designer</div>- ->
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td class="text-center">Cookies</td>
                                                    <td class="text-center">199</td>
                                                    <td class="text-center">
                                                        <div class="badge badge-pill badge-success">Good</div>
                                                    </td>
                                                    <td class="text-center d-inline-block dropdown">
                                                        <button type="button" id="PopoverCustomT-1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="btn btn-primary btn-sm">Improvements</button>
                                                        <div tabindex="-1" role="menu" aria-hidden="true" class="dropdown-menu dropdown-menu-right">
                                                            <h6 tabindex="-1" class="dropdown-header">Move Toothpaste to ends of the ailse for higher customer attraction and sales</h6>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="text-center text-muted">3</td>
                                                    <td>
                                                        <div class="widget-content p-0">
                                                            <div class="widget-content-wrapper">
                                                                <div class="widget-content-left flex2">
                                                                    <div class="widget-heading">6</div>
                                                                    <!- -<div class="widget-subheading opacity-7">UI Designer</div>- ->
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td class="text-center">Frozen Pizza</td>
                                                    <td class="text-center">42</td>
                                                    <td class="text-center">
                                                        <div class="badge badge-pill badge-warning">Medium</div>
                                                    </td>
                                                    <td class="text-center d-inline-block dropdown">
                                                        <button type="button" id="PopoverCustomT-1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="btn btn-primary btn-sm">Improvements</button>
                                                        <div tabindex="-1" role="menu" aria-hidden="true" class="dropdown-menu dropdown-menu-right">
                                                            <h6 tabindex="-1" class="dropdown-header">Move Toothpaste to ends of the ailse for higher customer attraction and sales</h6>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="text-center text-muted">4</td>
                                                    <td>
                                                        <div class="widget-content p-0">
                                                            <div class="widget-content-wrapper">
                                                                <div class="widget-content-left flex2">
                                                                    <div class="widget-heading">7</div>
                                                                    <!- -<div class="widget-subheading opacity-7">UI Designer</div>- ->
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td class="text-center">Water Bottles</td>
                                                    <td class="text-center">358</td>
                                                    <td class="text-center">
                                                        <div class="badge badge-pill badge-success">Good</div>
                                                    </td>
                                                    <td class="text-center d-inline-block dropdown">
                                                        <button type="button" id="PopoverCustomT-1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="btn btn-primary btn-sm">Improvements</button>
                                                        <div tabindex="-1" role="menu" aria-hidden="true" class="dropdown-menu dropdown-menu-right">
                                                            <h6 tabindex="-1" class="dropdown-header">Move Toothpaste to ends of the ailse for higher customer attraction and sales</h6>
                                                        </div>
                                                    </td>
                                                </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="d-block text-center card-footer">
                                            <button class="mr-2 btn-icon btn-icon-only btn btn-outline-danger"><i class="pe-7s-trash btn-icon-wrapper"> </i></button>
                                            <button class="btn-wide btn btn-success">Save</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!- -
                            <div class="col-md-12 col-lg-6">
                                <div class="mb-3 card">
                                    <div class="card-header-tab card-header">
                                        <div class="card-header-title">
                                            <i class="header-icon lnr-rocket icon-gradient bg-tempting-azure"> </i>
                                            Analysis
                                        </div>
                                        <i class="fa fa-lightbulb"></i>
                                    </div>
                                    <div class="widget-chart p-3">
                                        <p style="font-size: 20px"><b>Hotspots</b><p>
                                    </div>
                                        <div class="pt-2 card-body">
                                            <div class = "row">
                                                <div class="col-md-6">
                                                    <div class="widget-content">
                                                        <div class="widget-content-outer">
                                                            <div class="widget-content-wrapper">
                                                                <div class="widget-content-left">
                                                                    <div class="widget-numbers fsize-3 text-muted">498</div>
                                                                </div>
                                                                <div class="widget-content-right">
                                                                    <div class="text-muted opacity-6">Times Square</div>
                                                                </div>
                                                            </div>
                                                            <div class="widget-progress-wrapper mt-1">
                                                                <div class="progress-bar-sm progress-bar-animated-alt progress">
                                                                    <div class="progress-bar bg-danger" role="progressbar" aria-valuenow="80" aria-valuemin="0" aria-valuemax="500" style="width: 80%;"></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="widget-content">
                                                        <div class="widget-content-outer">
                                                            <div class="widget-content-wrapper">
                                                                <div class="widget-content-left">
                                                                    <div class="widget-numbers fsize-3 text-muted">450</div>
                                                                </div>
                                                                <div class="widget-content-right">
                                                                    <div class="text-muted opacity-6">Las Vegas</div>
                                                                </div>
                                                            </div>
                                                            <div class="widget-progress-wrapper mt-1">
                                                                <div class="progress-bar-sm progress-bar-animated-alt progress">
                                                                    <div class="progress-bar bg-danger" role="progressbar" aria-valuenow="72" aria-valuemin="0" aria-valuemax="500" style="width: 72%;"></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="widget-content">
                                                        <div class="widget-content-outer">
                                                            <div class="widget-content-wrapper">
                                                                <div class="widget-content-left">
                                                                    <div class="widget-numbers fsize-3 text-muted">422</div>
                                                                </div>
                                                                <div class="widget-content-right">
                                                                    <div class="text-muted opacity-6">Southlake</div>
                                                                </div>
                                                            </div>
                                                            <div class="widget-progress-wrapper mt-1">
                                                                <div class="progress-bar-sm progress-bar-animated-alt progress">
                                                                    <div class="progress-bar bg-danger" role="progressbar" aria-valuenow="44" aria-valuemin="0" aria-valuemax="500" style="width: 44%;"></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="widget-content">
                                                        <div class="widget-content-outer">
                                                            <div class="widget-content-wrapper">
                                                                <div class="widget-content-left">
                                                                    <div class="widget-numbers fsize-3 text-muted">402</div>
                                                                </div>
                                                                <div class="widget-content-right">
                                                                    <div class="text-muted opacity-6">Milpitas</div>
                                                                </div>
                                                            </div>
                                                            <div class="widget-progress-wrapper mt-1">
                                                                <div class="progress-bar-sm progress-bar-animated-alt progress">
                                                                    <div class="progress-bar bg-danger" role="progressbar" aria-valuenow="30" aria-valuemin="0" aria-valuemax="500" style="width: 30%;"></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <br>
                                            <p style="font-size: 20px"><b>Safe Spots</b><p>
                                            <div class="pt-2 card-body">
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <div class="widget-content">
                                                            <div class="widget-content-outer">
                                                                <div class="widget-content-wrapper">
                                                                    <div class="widget-content-left">
                                                                        <div class="widget-numbers fsize-3 text-muted">261</div>
                                                                    </div>
                                                                    <div class="widget-content-right">
                                                                        <div class="text-muted opacity-6">Dallas</div>
                                                                    </div>
                                                                </div>
                                                                <div class="widget-progress-wrapper mt-1">
                                                                    <div class="progress-bar-sm progress-bar-animated-alt progress">
                                                                        <div class="progress-bar bg-success" role="progressbar" aria-valuenow="80" aria-valuemin="0" aria-valuemax="500" style="width: 80%;"></div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="widget-content">
                                                            <div class="widget-content-outer">
                                                                <div class="widget-content-wrapper">
                                                                    <div class="widget-content-left">
                                                                        <div class="widget-numbers fsize-3 text-muted">248</div>
                                                                    </div>
                                                                    <div class="widget-content-right">
                                                                        <div class="text-muted opacity-6">Rochester</div>
                                                                    </div>
                                                                </div>
                                                                <div class="widget-progress-wrapper mt-1">
                                                                    <div class="progress-bar-sm progress-bar-animated-alt progress">
                                                                        <div class="progress-bar bg-success" role="progressbar" aria-valuenow="72" aria-valuemin="0" aria-valuemax="500" style="width: 72%;"></div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            -->
                            </div>
                        
                <script src="http://maps.google.com/maps/api/js?sensor=true"></script>
        </div>
    </div>

    <!-- Analytics Modal -->
    <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <!--<button type="button" class="close" data-dismiss="modal">&times;</button>-->
                    <h4 class="modal-title">Stored Analytics: <span id="cameraName"></span></h4>
                    <h6>current configuration: past <span id="configHours"></span> hrs</h6>
                </div>
                <div class="modal-body">
                    <div class="widget-content-wrapper">
                        <div class="widget-content-left">
                            <div class="accordion" id="accordionExample">
                              <div class="card">
                                <div class="card-header" id="headingOne">
                                  <h2 class="mb-0">
                                    <button class="btn widget-numbers fsize-3" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                      Total People
                                    </button>
                                  </h2>
                                </div>

                                <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordionExample">
                                  <div class="card-body">
                                        <canvas id="numppl-line"></canvas>
                                        <br>
                                        <canvas id="numppl-gender-line"></canvas>
                                        <br>
                                        <canvas id="numppl-race-line"></canvas>
                                        <br>
                                        <canvas id="numppl-age-line"></canvas>
                                  </div>
                                </div>
                              </div>
                            </div>
                        </div>
                        <br>
                    </div>
                    <br>
                    <div class="widget-content-left">
                        <div class="accordion" id="accordionExample">
                          <div class="card">
                            <div class="card-header" id="headingOne">
                              <h2 class="mb-0">
                                <button class="btn widget-numbers fsize-3" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne" onclick="getDemographicsJSON()">
                                  Demographics
                                </button>
                              </h2>
                            </div>

                            <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordionExample">
                              <div class="card-body">
                                <br>
                                <h6 class="fsize-3">Male</h6>
                                <br>
                                <p id="showMaleData"></p>
                                <br>
                                <h6 class="fsize-3">Female</h6>
                                <br>
                                <p id="showFemaleData"></p>
                              </div>
                            </div>
                          </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal" style="border: 1px solid #d3d3d3">Close</button>
                </div>
            </div>
        </div>
    </div>

<script type="text/javascript" src="./assets/scripts/main.js"></script>
<!-- <script type="text/javascript" src="./assets/scripts/heatmap.js"></script> -->
<!--<script type="text/javascript" src="./assets/scripts/main2.js"></script>-->

<script type="text/javascript">
    var map = L.map('map').setView([0,0], 1);

    L.tileLayer('https://api.maptiler.com/maps/streets/{z}/{x}/{y}.png?key=amtG9YDNUxzYgWJqZlup', {
        attribution: '<a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>',
    }).addTo(map)

    var heatData = [];

    var req = new XMLHttpRequest();
    req.overrideMimeType("application/json");
    req.open('GET', "analyticsGen/analyticsRecords/2021-06-0815:49:14.371359.json", true);
    req.onload  = function() {
       var json = JSON.parse(req.responseText);

       for(var i = 0 ; i < json["lonlat"].length ; i++){
            heatData.push(json["lonlat"][i]);
       }
    };
    req.send(null);

    console.log("Heat Data: ", heatData);
    // var heatData = [
    //     [37.31268511969728, -121.7778105863489, 0.1],
    //     [23.722657, 90.412525, 0.1],
    //     [23.701936, 90.415782, 0.1],
    //     [23.722099, 90.413981, 0.1],
    //     [23.703582, 90.414536, 0.1],
    //     [23.699689, 90.421493, 0.1],
    //     [23.705727, 90.412281, 0.1],
    //     [23.720692, 90.414056, 0.1],
    //     [23.706133, 90.412448, 0.1],
    //     [23.704677, 90.41166, 0.1],
    //     [23.703912, 90.413993, 0.1]
    // ];

    var heat = L.heatLayer(heatData, {
        radius: 5,
        max: 1.0,
        blur: 5,              
        gradient: {
            0.0: 'green',
            0.5: 'yellow',
            1.0: 'red'
        },
        minOpacity: 0.7
    }).addTo(map);
</script>

<script type="text/javascript">
    function getJSON(){
        var req = new XMLHttpRequest();
        req.overrideMimeType("application/json");
        req.open('GET', "analyticsGen/config.json", true);
        req.onload  = function() {
           var configJson = JSON.parse(req.responseText);
           configSpan = document.getElementById("configHours");
           configSpan.textContent = configJson["frequency"];
           cameraName = document.getElementById("cameraName");
           cameraName.textContent = configJson["name"];
        };
        req.send(null);
    }

    function getDemographicsJSON(){
        var req = new XMLHttpRequest();
        req.overrideMimeType("application/json");
        req.open('GET', "analyticsGen/analyticsRecords/latest.json", true);
        req.onload  = function() {
           var configJson = JSON.parse(req.responseText);
           var maleData = configJson["intersectionality"][0];
           var femaleData = configJson["intersectionality"][1];

           var headers = ["Age", "White", "Black", "Asian", "Indian", "Other"];

           var table = document.createElement("table");
           var table2 = document.createElement("table");

           var tr = table.insertRow(-1); 

           for(var i = 0 ; i < headers.length ; i++){
                var th = document.createElement("th");
                th.innerHTML = headers[i];
                tr.appendChild(th);
           }

           var age_categories = ["0-10", "11-25", "26-40", "41-60", "60+"];
           var race_categories = ["White", "Black", "Asian", "Indian", "Other"];

           for(var i = 0 ; i < age_categories.length ; i++){
                tr = table.insertRow(-1);

                var tabCell = tr.insertCell(-1);
                var tabCell2 = tr.insertCell(-1);
                var tabCell3 = tr.insertCell(-1);
                var tabCell4 = tr.insertCell(-1);
                var tabCell5 = tr.insertCell(-1);
                var tabCell6 = tr.insertCell(-1);

                tabCell.innerHTML = age_categories[i];
                tabCell2.innerHTML = maleData[0][i];
                tabCell3.innerHTML = maleData[1][i];
                tabCell4.innerHTML = maleData[2][i];
                tabCell5.innerHTML = maleData[3][i];
                tabCell6.innerHTML = maleData[4][i];
           }


           var divContainer = document.getElementById("showMaleData");
            divContainer.innerHTML = "";
            divContainer.appendChild(table);


            var tr = table2.insertRow(-1); 

            for(var i = 0 ; i < headers.length ; i++){
                 var th = document.createElement("th");
                 th.innerHTML = headers[i];
                 tr.appendChild(th);
            }

            for(var i = 0 ; i < age_categories.length ; i++){
                 tr = table2.insertRow(-1);

                 var tabCell = tr.insertCell(-1);
                 var tabCell2 = tr.insertCell(-1);
                 var tabCell3 = tr.insertCell(-1);
                 var tabCell4 = tr.insertCell(-1);
                 var tabCell5 = tr.insertCell(-1);
                 var tabCell6 = tr.insertCell(-1);

                 tabCell.innerHTML = age_categories[i];
                 tabCell2.innerHTML = femaleData[0][i];
                 tabCell3.innerHTML = femaleData[1][i];
                 tabCell4.innerHTML = femaleData[2][i];
                 tabCell5.innerHTML = femaleData[3][i];
                 tabCell6.innerHTML = femaleData[4][i];
            }


            var divContainer = document.getElementById("showFemaleData");
             divContainer.innerHTML = "";
             divContainer.appendChild(table2);
        };
        req.send(null);
    }
</script>
<script type="text/javascript">
    var doc = new jsPDF();
    var specialElementHandlers = {
        '#editor': function (element, renderer) {
            return true;
        }
    };

    $('#cmd').click(function () {
        doc.fromHTML($('#caContent').html(), 15, 15, {
            'width': 170,
                'elementHandlers': specialElementHandlers
        });
        doc.save('sample-file.pdf');
    });
</script>

</body>
<script>
    var x_values = [-25, -20, -15, -10, -5, 0, 5, 10, 15, 20, 25];
    var y_values = [-15, 15, -25, -5, -5, 0, 10, 5, -20, -15, 20];
    var z_values = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
    var distanced = [true, true, true, false, false, false, true, true, false, false, true];
    var masked = [true, true, true, true, true, true, true, true, true, true, true];;

    var color_values = [];
    var text_values = [];

    var undistancedCount = 0;
    var unmaskedCount = 0;

    for (let i = 0; i < masked.length; i++) {
        var unmasked = masked[i] == 2 ? true : false;
        var undistanced = distanced[i] == 0 ? true : false;

        var color = unmasked || undistanced ? 'rgba(255, 0, 0, 1)' : 'rgba(0, 255, 0, 1)';
        color_values.push(color);

        var distanced_txt = undistanced ? "undistanced" : "distanced";
        var unmasked_txt = unmasked ? "unmasked" : "not unmasked";

        var full_txt = distanced_txt + " and " + unmasked_txt;
        text_values.push(full_txt);

        if (undistanced)
            undistancedCount++;
        if (unmasked)
            unmaskedCount++;
    }

    //==========================

    var scatterData = [{
        x: x_values,
        y: y_values,
        z: z_values,
        name: 'people',
        mode: 'markers',
        marker: {
            color: color_values,
            size: 8,
            line: {
                width: 0.5
            },
            opacity: 0.8
        },
        type: 'scatter3d',
        text: text_values
    }];
    var scatterLayout = {
        margin: {
            l: 0,
            r: 0,
            b: 0,
            t: 0
        }
    };

    Plotly.newPlot('scatter_plot', scatterData, scatterLayout);
</script>
<script>
    Plotly.setPlotConfig({
        mapboxAccessToken: "pk.eyJ1Ijoic3Jhdml0MSIsImEiOiJja2JzY3NpcHgwMGJnMnZzYTY5ZWsyeDR6In0.CIOWohypCmf_oCzed32xRA"
    });

    var lat_prefix = '38.899';
    var lon_prefix = '-77.036';

    var mapData = [{
        type:'scattermapbox',
        lat:[lat_prefix+'27',lat_prefix+'38',lat_prefix+'58',
             lat_prefix+'39',lat_prefix+'22',lat_prefix+'42',
             lat_prefix+'31',lat_prefix+'50',lat_prefix+'58',
             lat_prefix+'16',lat_prefix+'594',lat_prefix+'26',
             lat_prefix+'45'],
        lon:[lon_prefix+'27',lon_prefix+'23',lon_prefix+'50',
             lon_prefix+'27',lon_prefix+'54',lon_prefix+'19',
             lon_prefix+'28',lon_prefix+'24',lon_prefix+'29',
             lon_prefix+'46',lon_prefix+'438',lon_prefix+'21',
             lon_prefix+'39'],
        mode:'marker',
        marker: {
            size:8
        }
    }];

    var mapLayout = {
        autosize: true,
        hovermode:'closest',
        mapbox: {
            bearing:0,
            center: {
                lat:lat_prefix+'5',
                lon:lon_prefix+'3'
            },
            pitch:0,
            zoom:17
        },
        margin: {
            l: 0,
            r: 0,
            b: 0,
            t: 0
        }
    };

    Plotly.newPlot('map_plot', mapData, mapLayout);
</script>
<script>
    var lat_prefix = '38.899';
    var lon_prefix = '-77.036';

    var realtimeData = {
        //camera_num: 1,
        location: "Times Square, NY",
        X3D_vals: 2.734,
        Y3D_vals: 9.672,
        Z3D_vals: 10.456,
        total_count_frame: 80,
        undistanced: 20,
        unmasked: 30,
        violations: 40,
        time_elapsed: 2200,
        total_count_start: 4598,
        overheadMapData: {
            "center": [lat_prefix, lon_prefix],
            "latCoords":[lat_prefix+'27',lat_prefix+'38',lat_prefix+'58'],
            "lonCoords":[lon_prefix+'27',lon_prefix+'23',lon_prefix+'50']
        }
    };

    var aggregateData = {
        enforcement_status: "Medium",
        average_dist: 4.32,
        average_unmasked: 9,
        average_undistanced: 5,
        cl_val: 980,
        violations_per_hr: 323
    };

/*
    var full_data = {
   "realtime": {
       "location": "Times Square, NY",
       "spatial_coordinates": {
           "X3D_vals": [2.734],
           "Y3D_vals": [9.672],
           "Z3D_vals": [10.456]
       },
       "tallies": {
           "total_count_frame": 80,
           "undistanced": 20,
           "unmasked": 30,
           "violations": 40
       },
       "time_elapsed": 2200,
       "total_count_start": 4598,
       "people_time": {"4:57": 23, "4:57": 23, "4:57": 23, "4:57": 23}[12, 3, 6, 109, 10],
       "overheadMapData": {
           "center": [38.899, -77.036],



           "latCoords": [38.89927, 38.89938, 38.89958],
           "lonCoords": [-77.03627, -77.03623, -77.03650]
       }
   },
   "aggregatetime": {
       "enforcement_status": "Medium",
       "average_dist": 4.32,
       "average_unmasked": 9,
       "average_undistanced": 9,
       "cl_val": 980,
       "violations_per_hr": 323
   }
};
*/

var dashboardDataRequest  = new XMLHttpRequest();
//dashboardDataRequest.open("POST", "http://3.137.221.232/requestData");
dashboardDataRequest.open("POST", "http://18.188.84.0/requestData");
dashboardDataRequest.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
dashboardDataRequest.send(JSON.stringify({
    "option1": "value1"
}));
dashboardDataRequest.onload = function(e) {
  var responseText = dashboardDataRequest.responseText;
  full_data = JSON.parse(responseText);
}


    /*REALTIME*/

    document.getElementById("totalCountVal").innerHTML = full_data["realtime"]["tallies"]["total_count_frame"];
    document.getElementById("undistancedCountVal").innerHTML = full_data["realtime"]["tallies"]["undistanced"];
    document.getElementById("unmaskedCountVal").innerHTML = full_data["realtime"]["tallies"]["unmasked"];
    document.getElementById("violationsCountVal").innerHTML = full_data["realtime"]["tallies"]["violations"];

    /*AGGREGATE*/

    document.getElementById("enforcement_status_val").innerHTML = full_data["aggregatetime"]["enforcement_status"];
    document.getElementById("average_dist_val").innerHTML = full_data["aggregatetime"]["average_dist"];
    document.getElementById("average_unmasked_val").innerHTML = full_data["aggregatetime"]["average_unmasked"];
    document.getElementById("average_undistanced_val").innerHTML = full_data["aggregatetime"]["average_undistanced"];
    //document.getElementById("cl_val").innerHTML = full_data["aggregatetime"]["cl_val"];
    //document.getElementById("violations_per_hr_val").innerHTML = full_data["aggregatetime"]["violations_per_hr"];
    
    mapData[0].lat = full_data.realtime.overheadMapData.latCoords;
    mapData[0].lon = full_data.realtime.overheadMapData.lonCoords;
    mapLayout.mapbox.center.lat = full_data.realtime.overheadMapData.center[0];
    mapLayout.mapbox.center.lon = full_data.realtime.overheadMapData.center[1];
    Plotly.newPlot('map_plot', mapData, mapLayout);
</script>

</html>